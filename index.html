<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortnite Server Status</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Using Inter font */
        body {
            font-family: 'Inter', sans-serif;
            /* Making the body background transparent for overlay effect */
            background-color: transparent;
        }
        /* Simple animation for the status light */
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 0.7;
            }
            50% {
                transform: scale(1.1);
                opacity: 1;
            }
        }
        .pulse-anim {
            animation: pulse 2s infinite;
        }
        /* Adding a text shadow for better readability on any background */
        .text-shadow {
            text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.8);
        }
    </style>
</head>
<body class="text-white flex items-center justify-center h-screen">

    <!-- Main container for the overlay, now with a transparent background -->
    <div id="status-container" class="bg-transparent p-8 rounded-2xl w-full max-w-md text-center">
        
        <!-- Status Indicator with increased background opacity for better contrast -->
        <div id="status-indicator" class="flex items-center justify-center space-x-4 p-6 bg-gray-900/75 rounded-lg backdrop-blur-sm">
            <div id="status-light" class="w-6 h-6 rounded-full bg-gray-500 transition-colors duration-500"></div>
            <p id="status-text" class="text-2xl font-semibold text-shadow">Lade Status...</p>
        </div>

    </div>

    <script>
        // DOM elements
        const statusLight = document.getElementById('status-light');
        const statusText = document.getElementById('status-text');
        const statusIndicator = document.getElementById('status-indicator');

        // The new API endpoint for Epic Games status
        const apiUrl = 'https://status.epicgames.com/api/v2/components.json';

        /**
         * Fetches and updates the server status on the page.
         */
        async function fetchStatus() {
            try {
                // Fetch data from the API
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`HTTP-Fehler! Status: ${response.status}`);
                }
                const data = await response.json();

                // Find the specific component for Fortnite (case-insensitive)
                const fortniteComponent = data.components.find(component => component.name.toLowerCase() === 'fortnite');

                if (fortniteComponent) {
                    // Extract status information from the Fortnite component
                    const serverStatus = fortniteComponent.status;
                    updateUI(serverStatus);
                } else {
                    throw new Error('Fortnite-Komponente nicht in der API-Antwort gefunden.');
                }

            } catch (error) {
                // Handle errors during the fetch process
                console.error("Fehler beim Abrufen des Serverstatus:", error);
                updateUI('error');
            }
        }

        /**
         * Updates the UI elements based on the server status.
         * @param {string} status - The current server status (e.g., 'operational', 'degraded_performance').
         */
        function updateUI(status) {
            // Remove previous status classes
            statusLight.classList.remove('bg-green-500', 'bg-red-500', 'bg-yellow-500', 'bg-blue-500', 'bg-gray-500', 'pulse-anim');
            statusText.classList.remove('text-green-400', 'text-red-400', 'text-yellow-400', 'text-blue-400');

            // Set text and colors based on the new status values
            switch (status) {
                case 'operational':
                    statusLight.classList.add('bg-green-500', 'pulse-anim');
                    statusText.textContent = 'Online';
                    statusText.classList.add('text-green-400');
                    break;
                case 'degraded_performance':
                    statusLight.classList.add('bg-yellow-500');
                    statusText.textContent = 'Leistungsprobleme';
                    statusText.classList.add('text-yellow-400');
                    break;
                case 'partial_outage':
                    statusLight.classList.add('bg-yellow-500');
                    statusText.textContent = 'Teilweiser Ausfall';
                    statusText.classList.add('text-yellow-400');
                    break;
                case 'major_outage':
                    statusLight.classList.add('bg-red-500');
                    statusText.textContent = 'Schwerer Ausfall';
                    statusText.classList.add('text-red-400');
                    break;
                case 'under_maintenance':
                    statusLight.classList.add('bg-blue-500');
                    statusText.textContent = 'Wartungsarbeiten';
                    statusText.classList.add('text-blue-400');
                    break;
                default: // Error or unknown status
                    statusLight.classList.add('bg-gray-500');
                    statusText.textContent = 'Fehler';
                    console.warn('Unbekannter Status empfangen:', status); // Log unknown status
                    break;
            }
        }

        // --- Initial Load and Interval ---

        // Fetch the status immediately when the page loads
        fetchStatus();

        // Set an interval to automatically refresh the status every 10 seconds (10,000 milliseconds)
        setInterval(fetchStatus, 10000);
    </script>

</body>
</html>
